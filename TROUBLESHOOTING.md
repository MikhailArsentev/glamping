# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º (Troubleshooting)

## –ü—Ä–æ–±–ª–µ–º–∞: 404 –æ—à–∏–±–∫–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –°–∏–º–ø—Ç–æ–º—ã
- –õ–æ–∫–∞–ª—å–Ω–æ —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–µ–ª—ã–π —ç–∫—Ä–∞–Ω
- –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –æ—à–∏–±–∫–∏ 404 –¥–ª—è —Ñ–∞–π–ª–æ–≤ `/_nuxt/...`
- –û—à–∏–±–∫–∏ —Ç–∏–ø–∞: `Failed to load resource: 404`

### –ü—Ä–∏—á–∏–Ω—ã
1. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ—Ä—Ç–æ–≤** - Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç
2. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ** - PM2 –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª –ø—Ä–æ—Ü–µ—Å—Å
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞** - .output –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞

### –†–µ—à–µ–Ω–∏–µ

#### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /home/glamping/www
bash <(curl -s https://raw.githubusercontent.com/your-repo/glamping/main/scripts/debug-deployment.sh)
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
cd /home/glamping/www

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 list

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs glamping --lines 50

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—á–∞–µ—Ç
curl -I http://localhost:3001

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx
sudo nginx -t
sudo systemctl status nginx
```

#### –®–∞–≥ 2: –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø–æ—Ä—Ç –≤ Nginx

–ï—Å–ª–∏ –ø–æ—Ä—Ç—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç (PM2 –Ω–∞ 3001, Nginx –Ω–∞ 3000):

```bash
# –°–∫–∞—á–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
sudo wget https://raw.githubusercontent.com/your-repo/glamping/main/scripts/fix-nginx-port.sh -O /tmp/fix-nginx-port.sh

# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
sudo chmod +x /tmp/fix-nginx-port.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
sudo /tmp/fix-nginx-port.sh
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nano /etc/nginx/sites-available/glamping

# –ò–∑–º–µ–Ω–∏—Ç—å –≤—Å–µ proxy_pass —Å –ø–æ—Ä—Ç–∞ 3000 –Ω–∞ 3001
# proxy_pass http://localhost:3001;

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo nginx -t
sudo systemctl restart nginx
```

#### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd /home/glamping/www

# –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
pm2 delete glamping

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
pm2 start ecosystem.config.cjs --env production

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
pm2 save

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 list
pm2 logs glamping --lines 20
```

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
curl http://localhost:3001

# –ß–µ—Ä–µ–∑ Nginx
curl http://localhost

# –ò–∑ –±—Ä–∞—É–∑–µ—Ä–∞
# –û—Ç–∫—Ä–æ–π—Ç–µ http://your-domain.com
```

---

## –ü—Ä–æ–±–ª–µ–º–∞: PM2 –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –°–∏–º–ø—Ç–æ–º—ã
- `pm2 list` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å `errored` –∏–ª–∏ `stopped`
- –í –ª–æ–≥–∞—Ö –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞ "Cannot find module"

### –†–µ—à–µ–Ω–∏–µ

```bash
cd /home/glamping/www

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤
ls -la .output/
ls -la .output/server/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Node.js –≤–µ—Ä—Å–∏—é
node -v  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å v20.x

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
rm -rf node_modules package-lock.json
npm install

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm run build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
pm2 start ecosystem.config.cjs --env production
```

---

## –ü—Ä–æ–±–ª–µ–º–∞: Nginx –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 502 Bad Gateway

### –°–∏–º–ø—Ç–æ–º—ã
- –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "502 Bad Gateway"
- `curl http://localhost:3001` –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

### –†–µ—à–µ–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
pm2 list

# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç—å
cd /home/glamping/www
pm2 start ecosystem.config.cjs --env production

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç —Å–ª—É—à–∞–µ—Ç—Å—è
netstat -tlnp | grep 3001

# –ï—Å–ª–∏ –ø–æ—Ä—Ç –Ω–µ —Å–ª—É—à–∞–µ—Ç—Å—è - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs glamping --lines 100
```

---

## –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ, –Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –≤–∏–¥–Ω—ã

### –ü—Ä–∏—á–∏–Ω—ã
- –ö—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
- –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –Ω–µ –∑–∞–º–µ–Ω–∏–ª–∞—Å—å
- PM2 –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª –ø—Ä–æ—Ü–µ—Å—Å

### –†–µ—à–µ–Ω–∏–µ

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /home/glamping/www

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞—Ç—É .output
ls -la .output/

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 delete glamping
pm2 start ecosystem.config.cjs --env production

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à Nginx (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
sudo systemctl reload nginx

# –í –±—Ä–∞—É–∑–µ—Ä–µ
# Ctrl+Shift+R (–∂–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)
# –ò–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à —Å–∞–π—Ç–∞
```

---

## –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "EADDRINUSE" - –ø–æ—Ä—Ç —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –°–∏–º–ø—Ç–æ–º—ã
```
Error: listen EADDRINUSE: address already in use :::3001
```

### –†–µ—à–µ–Ω–∏–µ

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 3001
sudo lsof -i :3001

# –ò–ª–∏
sudo netstat -tlnp | grep 3001

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
sudo kill -9 <PID>

# –ò–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ PM2
pm2 delete all
pm2 start ecosystem.config.cjs --env production
```

---

## –ü—Ä–æ–±–ª–µ–º–∞: "Module not found" –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –°–∏–º–ø—Ç–æ–º—ã
```
Error: Cannot find module '@vue/server-renderer'
```

### –†–µ—à–µ–Ω–∏–µ

```bash
cd /home/glamping/www

# –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
rm -rf node_modules .nuxt .output

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm ci

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
npm run build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart glamping
```

---

## –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∞–π—Ç–∞

### –ü—Ä–∏—á–∏–Ω—ã
- –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
- PM2 –≤ —Ä–µ–∂–∏–º–µ fork –≤–º–µ—Å—Ç–æ cluster
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤

### –†–µ—à–µ–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∂–∏–º PM2
pm2 show glamping

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: exec_mode: cluster, instances: max

# –ï—Å–ª–∏ –Ω–µ—Ç - –æ–±–Ω–æ–≤–∏—Ç—å ecosystem.config.cjs
# –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
free -h
top

# –í–∫–ª—é—á–∏—Ç—å gzip –≤ Nginx
sudo nano /etc/nginx/nginx.conf
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å gzip –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
sudo systemctl restart nginx
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
pm2 list
sudo systemctl status nginx
node -v

# –õ–æ–≥–∏
pm2 logs glamping --lines 100
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/nginx/access.log

# –ü–æ—Ä—Ç—ã
sudo netstat -tlnp | grep -E "(3001|80)"
sudo lsof -i :3001

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
pm2 monit
htop

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
curl -I http://localhost:3001
curl -I http://localhost
curl -I http://your-domain.com

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t
cat /etc/nginx/sites-available/glamping
cat /home/glamping/www/ecosystem.config.cjs
```

---

## –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
pm2 delete all
sudo systemctl stop nginx

# 2. –û—á–∏—Å—Ç–∏—Ç—å
cd /home/glamping/www
rm -rf .output* node_modules

# 3. –°–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions

# 4. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –∑–∞–ø—É—Å—Ç–∏—Ç—å Nginx
sudo systemctl start nginx

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
pm2 list
curl http://localhost:3001
curl http://localhost
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–≤–æ–¥
2. –°–æ–±–µ—Ä–∏—Ç–µ –ª–æ–≥–∏: `pm2 logs glamping --lines 200 > logs.txt`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É

**Emergency hotfix:** –ï—Å–ª–∏ —Å–∞–π—Ç —É–ø–∞–ª –∏ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

```bash
cd /home/glamping/www

# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø
pm2 stop glamping
ls -lt | grep backup
mv .output .output.broken
mv .output.backup.YYYYMMDD_HHMMSS .output
pm2 restart glamping
```

